<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üèÅ –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ó–∞–¥–∞–Ω–∏—è</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Rubik&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
</head>
<body>
    <!-- –ö–Ω–æ–ø–∫–∞ –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é -->
    <button class="menu-toggle">‚ò∞</button>

    <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
    <nav id="sideMenu" class="side-menu">
        <button class="menu-close">‚úñ</button>
        <ul>
            <li><a href="/index">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
            <li><a href="/favorites">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω—ã–µ</a></li>
            <li><a href="/my_tasks">üß∞ –ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è</a></li>
            <li><a href="/completions">‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</a></li>
            <li><a href="/logout">üö™ –í—ã–π—Ç–∏</a></li>
        </ul>
    </nav>

    <div class="container">
        <h2>üèÅ –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h2>

        {% if tasks %}
            {% for task in tasks %}
                <div class="card" data-task-id="{{ task.id }}">
                    <h3>{{ task.title or "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è" }}</h3>
                    <p>{{ task.description[:200] }}...</p>
                    <p class="status-completed">–°—Ç–∞—Ç—É—Å: –ó–∞–≤–µ—Ä—à–µ–Ω–æ</p>
                    <small>üìÖ –ó–∞–¥–∞–Ω–∏–µ ID: {{ task.id }}</small>
                </div>
            {% endfor %}
        {% else %}
            <p class="no-tasks">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π.</p>
        {% endif %}
    </div>

    <script>
        const socket = io();

        socket.on('task_completed', (task) => {
            const container = document.querySelector('.container');
            const noTasks = document.querySelector('.no-tasks');
            if (noTasks) {
                noTasks.remove();
            }

            const card = document.createElement('div');
            card.className = 'card';
            card.setAttribute('data-task-id', task.id);
            card.innerHTML = `
                <h3>${task.title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
                <p>${(task.description || '').slice(0, 200)}...</p>
                <p class="status-completed">–°—Ç–∞—Ç—É—Å: –ó–∞–≤–µ—Ä—à–µ–Ω–æ</p>
                <small>üìÖ –ó–∞–¥–∞–Ω–∏–µ ID: ${task.id}</small>
            `;
            container.appendChild(card);
        });

        function toggleMenu() {
            const menu = document.getElementById('sideMenu');
            const toggle = document.querySelector('.menu-toggle');
            menu.classList.toggle('open');
            toggle.style.transform = menu.classList.contains('open') ? 'rotate(90deg)' : 'rotate(0deg)';
        }
    </script>
</body>
</html>