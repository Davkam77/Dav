<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>‚≠ê –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body style="background: url('{{ background }}') no-repeat center center fixed; background-size: cover; color: white;">

<button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>

<nav id="sideMenu" class="side-menu">
    <ul>
        <li><a href="/index">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a href="/favorites">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω—ã–µ</a></li>
        <li><a href="/my_tasks">üß∞ –ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è</a></li>
        <li><a href="/completions">‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</a></li>
        <li><a href="/logout">üö™ –í—ã–π—Ç–∏</a></li>
    </ul>
</nav>

<div class="main-content">
    <h1 class="glow" style="text-align:center;">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h1>

    <div class="search-box">
        <input type="text" id="searchInput" placeholder="üîç –ü–æ–∏—Å–∫ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º...">
    </div>

    {% if tasks %}
    <div class="cards" id="cardsContainer">
        {% for job in tasks %}
        <div class="card fade-in">
            <h3 class="card-title">{{ job.title or "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è" }}</h3>
          
            <div class="card-info">
              {% if job.budget %}<p><b>üí∞ –ë—é–¥–∂–µ—Ç:</b> {{ job.budget }}</p>{% endif %}
              {% if job.duration %}<p><b>‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</b> {{ job.duration }}</p>{% endif %}
              {% if job.experience %}<p><b>üìò –û–ø—ã—Ç:</b> {{ job.experience }}</p>{% endif %}
              {% if job.hours_per_week %}<p><b>‚åõ –ß–∞—Å–æ–≤/–Ω–µ–¥–µ–ª—è:</b> {{ job.hours_per_week }}</p>{% endif %}
              {% if job.region %}<p><b>üåç –†–µ–≥–∏–æ–Ω:</b> {{ job.region }}</p>{% endif %}
              {% if job.payment %}<p><b>üí≥ –û–ø–ª–∞—Ç–∞:</b> {{ job.payment }}</p>{% endif %}
            </div>
          
            {% if job.description %}
            <div class="job-desc">
              <span class="short">{{ job.description[:250] }}...</span>
              <span class="full" style="display:none;">{{ job.description }}</span>
              <a href="#" onclick="toggleDesc(this); return false;">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ</a>
            </div>
            {% endif %}
          
            <a class="open-link" href="{{ job.link }}" target="_blank">üîó –û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞–Ω–∏–µ</a>
          </div>
          

        {% endfor %}
    </div>
    {% else %}
        <p style="text-align:center;">‚≠ê –ü–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π</p>
    {% endif %}
</div>

<script>
function toggleMenu() {
    const menu = document.getElementById("sideMenu");
    if (menu) menu.classList.toggle("open");
}

function toggleDesc(link) {
    const shortSpan = link.parentElement.querySelector(".short");
    const fullSpan = link.parentElement.querySelector(".full");

    if (shortSpan.style.display === "none") {
        shortSpan.style.display = "inline";
        fullSpan.style.display = "none";
        link.innerText = "–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ";
    } else {
        shortSpan.style.display = "none";
        fullSpan.style.display = "inline";
        link.innerText = "–°–∫—Ä—ã—Ç—å";
    }
}

const searchInput = document.getElementById('searchInput');
const cardsContainer = document.getElementById('cardsContainer');

if (searchInput) {
    searchInput.addEventListener('input', function () {
        const filter = searchInput.value.toLowerCase();
        const cards = cardsContainer.querySelectorAll('.card');

        cards.forEach(card => {
            const title = card.querySelector('.card-title')?.textContent.toLowerCase() || '';
            const desc = card.querySelector('.job-desc')?.textContent.toLowerCase() || '';

            if (title.includes(filter) || desc.includes(filter)) {
                card.classList.remove('fade-out');
                card.classList.add('fade-in');
                card.style.display = 'block';
            } else {
                card.classList.remove('fade-in');
                card.classList.add('fade-out');
                setTimeout(() => {
                    card.style.display = 'none';
                }, 400);
            }
        });
    });
}
</script>

</body>
</html>
